{% extends "layouts/base-dashboard-patients.html" %}
{% load i18n static widget_tweaks %}

{% block extrastyle %}
  <!-- External CSS dependencies -->
  <link rel="stylesheet" href="{% static 'dist/jquery.multi-select.css' %}">
  <link rel="stylesheet" href="https://unpkg.com/@majidh1/jalalidatepicker/dist/jalalidatepicker.min.css">
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
{% endblock extrastyle %}

{% block content %}
<div class="max-w-5xl mx-auto my-5">
  <!-- Container with light/dark background and border -->
  <div class="bg-white dark:bg-gray-800 p-5 rounded-xl border border-gray-200 dark:border-gray-700">
    <h1 class="text-2xl font-bold dark:text-white mb-4" style="font-family: 'BTitr', sans-serif;">
      {% trans "Questionnaire" %} {{questionnaire_name}}
    </h1>

      <!-- Display instructions on top -->

      <div class="mb-4 p-4 dark:bg-gray-700 rounded text-sm">
        {% if instructions %}
        <span style="font-family: 'Sahel'; sans-serif;">
          {{ instructions }}
        </span>
        {% endif %}

        <br><br>
      <table>
        <thead>
          <tr>
            {% if reference_article %}
            <th>
              <a href="{{ reference_article }}" target="_blank">{% trans "Reference Article" %}</a>
            </th>
            {% endif %}

            {% if validator %}
            <th>
              {% trans "Local validator" %}: {{ validator }}
            </th>
            {% endif %}
          </tr>

        </thead>
      </table>
      </div>


    <form method="post" novalidate>
      {% csrf_token %}
      <!-- Responsive table with Tailwind classes -->
      <table class="w-full border-collapse">
        <thead>
          <tr class="border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800">
            <th class="w-1/12 px-4 py-2 text-left text-gray-600 dark:text-gray-300">

            </th>
            <th class="w-7/12 px-4 py-2 text-left text-gray-600 dark:text-gray-300">
              {% trans "Question" %}
            </th>
            <th class="w-4/12 px-4 py-2 text-left text-gray-600 dark:text-gray-300">
              {% trans "Answer" %}
            </th>
          </tr>
        </thead>
        <tbody class="bg-white dark:bg-gray-900">
          {% for field in form %}
            {% if field.name|slice:":2" == "q_" %}
              <tr class="border-b border-gray-200 dark:border-gray-700">
                <td class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">
                  {{ forloop.counter }}
                </td>
                <td class="px-4 py-2 text-gray-700 dark:text-gray-300">
                  <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                </td>
                <td class="px-4 py-2 text-gray-700 dark:text-gray-300">
                  {% render_field field class="w-full" %}
                  {% if field.errors %}
                    <div class="text-sm text-red-600 mt-1">
                      {{ field.errors|join:", " }}
                    </div>
                  {% endif %}
                </td>
              </tr>
            {% endif %}
          {% endfor %}
        </tbody>
      </table>

      <div class="mt-6 flex justify-end">
        <button
          type="submit"
          class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
        >
          {% trans "Submit Questionnaire" %}
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock content %}

{% block extra_js %}
<!-- JS dependencies -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="{% static 'django_select2/django_select2.js' %}"></script>
<script src="https://unpkg.com/@majidh1/jalalidatepicker/dist/jalalidatepicker.min.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Initialize Select2 for any select widgets, if needed.
    $('.django-select2').select2();
  });
</script>
{% endblock extra_js %}
